<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

</claude-mem-context>

# teamwork-js

Node.js cross-platform version of teamwork plugin.

## Key Differences from Bash Version

- Pure JavaScript with JSDoc type annotations (no TypeScript build step)
- No jq dependency - native JSON parsing
- No bash dependency - runs with Node.js
- Cross-platform file paths using path.join()
- Same stdin/stdout JSON contracts for hooks

## File Structure

- src/lib/types.js - JSDoc type definitions (@typedef)
- src/lib/file-lock.js - Cross-platform file locking
- src/lib/task-utils.js - Task management utilities
- src/scripts/*.js - CLI scripts
- src/hooks/*.js - Lifecycle hooks

## No Build Step Required

Scripts run directly from source. No compilation needed.

## Hook Configuration

**IMPORTANT**: hooks.json must use explicit `node` prefix for cross-platform compatibility.

```json
// WRONG - shebang doesn't work on Windows
"command": "${CLAUDE_PLUGIN_ROOT}/src/hooks/stop-hook.js"

// CORRECT - explicit node invocation
"command": "node ${CLAUDE_PLUGIN_ROOT}/src/hooks/stop-hook.js"
```

Hook paths: `src/hooks/*.js` (NOT `hooks/*.sh` like the bash version)

## Multi-Session Coordination

### Shared State Management
- Tasks stored in `~/.claude/teamwork/{project}/{team}/tasks/{id}.json`
- Session state in `~/.claude/teamwork/{project}/{team}/session.json`
- Loop state per terminal in `~/.claude/teamwork/.loop-state/{pid}.json`

### Concurrency Safety
- Workers must claim tasks atomically (file-based locking)
- Task status updates must be atomic operations
- Multiple workers can run in parallel without conflicts

### Worker Coordination
- Each worker runs in separate terminal/session
- Workers claim tasks based on role matching
- Workers communicate through shared task files
- Coordinator monitors progress through task status

## Development Rules

### Document Synchronization

**When modifying teamwork-js commands or agents, you MUST check and update the following files:**

| File | Location | Role |
|------|----------|------|
| `teamwork.md` | `commands/teamwork.md` | Coordination command (planning phase) |
| `teamwork-worker.md` | `commands/teamwork-worker.md` | Worker command (execution phase) |
| `teamwork-status.md` | `commands/teamwork-status.md` | Status dashboard command |
| `coordinator/AGENT.md` | `agents/coordinator/AGENT.md` | Main orchestration agent |
| `worker/AGENT.md` | `agents/worker/AGENT.md` | General purpose worker agent |
| Role agents | `agents/{role}/AGENT.md` | Specialized worker agents (frontend, backend, etc.) |

### Task File Format

```json
{
  "id": "string",
  "title": "string",
  "description": "string",
  "role": "frontend|backend|devops|test|docs|security|review|worker",
  "status": "open|in_progress|resolved",
  "created_at": "ISO8601",
  "updated_at": "ISO8601",
  "claimed_by": "session_id or null",
  "evidence": ["string array"]
}
```

### Session State Format

```json
{
  "project": "string",
  "team": "string",
  "goal": "string",
  "created_at": "ISO8601",
  "updated_at": "ISO8601",
  "stats": {
    "total": 0,
    "open": 0,
    "in_progress": 0,
    "resolved": 0
  }
}
```
